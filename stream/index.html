<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pinkjelly.live</title>
    <link href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css" rel="stylesheet">
    <style></style>
</head>

<body class="p-4 bg-transparent text-transparent">

    <div id="giffy-player" class="absolute z-10 inset-0 flex items-center justify-center hidden">
        <img src="https://media.giphy.com/media/lO5vvG3F58rb8wMmxf/giphy.gif" class="w-full" />
    </div>

    <script type="application/json" id="sounds-json">
        [
  { "id": 1, "src": "aaah.mp3" },
  { "id": 2, "src": "absolutely-huge.mp3" },
  { "id": 3, "src": "awww.mp3" },
  { "id": 4, "src": "excuse-me.mp3" },
  { "id": 5, "src": "fucked-it.mp3" },
  { "id": 6, "src": "ha-ha.mp3" },
  { "id": 7, "src": "hhhooo.mp3" },
  { "id": 8, "src": "holy-shit.mp3" },
  { "id": 9, "src": "i-am-stressed.mp3" },
  { "id": 10, "src": "i-cant.mp3" },
  { "id": 11, "src": "i-dont-wanna-talk-about-it.mp3" },
  { "id": 12, "src": "i-like-ox.mp3" },
  { "id": 13, "src": "i-touched-his.mp3" },
  { "id": 14, "src": "i-touched-the-man.mp3" },
  { "id": 15, "src": "i-wanna-come.mp3" },
  { "id": 16, "src": "i-will-take-that.mp3" },
  { "id": 17, "src": "i-wouldnt-mind-5-inches.mp3" },
  { "id": 18, "src": "im-feeling-it.mp3" },
  { "id": 19, "src": "it-happened.mp3" },
  { "id": 20, "src": "its-everywhere.mp3" },
  { "id": 21, "src": "its-so-good.mp3" },
  { "id": 22, "src": "its-unexpectedly-thick.mp3" },
  { "id": 23, "src": "just-put-it-in.mp3" },
  { "id": 24, "src": "lets-go.mp3" },
  { "id": 25, "src": "make-it-work.mp3" },
  { "id": 26, "src": "my-controller-is-all-wet-now.mp3" },
  { "id": 27, "src": "nipples.mp3" },
  { "id": 28, "src": "nuts.mp3" },
  { "id": 29, "src": "oh-no.mp3" },
  { "id": 30, "src": "omg-you-guys.mp3" },
  { "id": 31, "src": "omg-you-guys-2.mp3" },
  { "id": 32, "src": "ooo-ill-take-that.mp3" },
  { "id": 33, "src": "ooo-the.mp3" },
  { "id": 34, "src": "oooh-ha-ha-ha.mp3" },
  { "id": 35, "src": "oooh.mp3" },
  { "id": 36, "src": "oooh2.mp3" },
  { "id": 37, "src": "pink.mp3" },
  { "id": 38, "src": "shiiiit.mp3" },
  { "id": 39, "src": "squeal.mp3" },
  { "id": 40, "src": "that-was-a-thick-one.mp3" },
  { "id": 41, "src": "that-was-hard.mp3" },
  { "id": 42, "src": "the-fuck.mp3" },
  { "id": 43, "src": "this-is-what-happens-when-you-get.mp3" },
  { "id": 44, "src": "uhmm.mp3" },
  { "id": 45, "src": "uuhuuh.mp3" },
  { "id": 46, "src": "whaaat.mp3" },
  { "id": 47, "src": "what-do-you-mean.mp3" },
  { "id": 48, "src": "what-is-going-on-right-now.mp3" },
  { "id": 49, "src": "yeah-man.mp3" },
  { "id": 50, "src": "100.mp3" },
  { "id": 51, "src": "69.mp3" },
  { "id": 53, "src": "behind-me.mp3" },
  { "id": 54, "src": "enjoy.mp3" },
  { "id": 55, "src": "gg.mp3" },
  { "id": 56, "src": "i-cant-see-anything.mp3" },
  { "id": 57, "src": "i-dont-know-what-to-say-to-you.mp3" },
  { "id": 58, "src": "i-feel-like.mp3" },
  { "id": 59, "src": "i-must-say.mp3" },
  { "id": 60, "src": "im-jumping-in.mp3" },
  { "id": 61, "src": "im-so-disappointed-in-myself.mp3" },
  { "id": 62, "src": "my-services-are-available-for-hire.mp3" },
  { "id": 63, "src": "nooo.mp3" },
  { "id": 64, "src": "that-flowed-very-nicely.mp3" },
  { "id": 65, "src": "the-perfect-number-doesnt-exist.mp3" },
  { "id": 66, "src": "the-suction.mp3" },
  { "id": 67, "src": "there-is-literally.mp3" },
  { "id": 68, "src": "very-nice-very-nice.mp3" },
  { "id": 69, "src": "well.mp3" },
  { "id": 70, "src": "what-happened.mp3" },
  { "id": 71, "src": "i-wasnt-expecting-that.mp3" },
  { "id": 72, "src": "thats-huge.mp3" },
  { "id": 73, "src": "are-you-in.mp3" },
  { "id": 74, "src": "awww-2.mp3" },
  { "id": 75, "src": "i-apologise.mp3" },
  { "id": 76, "src": "i-dont-know-how-to-feel-about-that-one.mp3" },
  { "id": 77, "src": "i-know-you-just-wanna-you-know.mp3" },
  { "id": 78, "src": "junk.mp3" },
  { "id": 79, "src": "naughty-naughty.mp3" },
  { "id": 80, "src": "no-question-about-it.mp3" },
  { "id": 81, "src": "oh-my.mp3" },
  { "id": 82, "src": "that-would-have-been-so-good.mp3" },
  { "id": 83, "src": "what-is-that.mp3" },
  { "id": 84, "src": "without-a-doubt.mp3" },
  { "id": 85, "src": "everything-hurts.mp3" },
  { "id": 86, "src": "explosive-diarrhea.mp3" },
  { "id": 87, "src": "gimme-a-moment-to-recoup.mp3" },
  { "id": 88, "src": "it-actually-hurts.mp3" },
  { "id": 89, "src": "it-was-easy-to-transition.mp3" },
  { "id": 90, "src": "it-went-for-a-really-long-time.mp3" },
  { "id": 91, "src": "moist.mp3" },
  { "id": 92, "src": "old-me-would-have-done-it.mp3" },
  { "id": 93, "src": "that-was-a-lot.mp3" },
  { "id": 94, "src": "uuuh.mp3" },
  { "id": 95, "src": "eeh.mp3" },
  { "id": 96, "src": "eeheeh.mp3" },
  { "id": 97, "src": "f-me.mp3" },
  { "id": 98, "src": "fu.mp3" },
  { "id": 99, "src": "i-wasnt-expecting-that-to-go-in.mp3" }
]
    </script>
    <script>
        const PLAYLIST_MAX = 10;
        const sounds = JSON.parse(document.getElementById('sounds-json').textContent).sort((s1, s2) => s1.src < s2.src ? -1 : 1);
        const ALL_IDS = sounds.map(s => s.id);

        function playGiffy(id) {
            const root = document.getElementById('giffy-player');
            root.querySelector('img').setAttribute('src', 'https://media.giphy.com/media/' + id + '/giphy.gif');
            root.classList.remove('hidden');
            setTimeout(() => {
                root.classList.add('hidden');
            }, 8000);
        }

        function playAudio(url, format) {
            const audio = new Howl({ src: [url], format: Boolean(format) ? [format] : undefined });
            audio.play();
        }

        function playSound(id) {
            let sound;
            if (id === '_random') {
                sound = sounds[Math.floor(Math.random() * sounds.length)];
            } else {
                sound = sounds.find(sound => sound.id == id);
            }

            if (!sound) {
                return;
            }
            playAudio('../sounds/' + sound.src);
        }

        function playMashup(hash) {
            const ids = hashToIds(hash);
            const audios = ids.map(id => sounds.find(s => s.id == id));
            if (!audios.length) {
                return;
            }
            const howls = audios.map(s => new Howl({ src: ['../sounds/' + s.src] }));
            howls.forEach((audio, idx) => {
                if (idx + 1 >= howls.length) return;
                audio.on('end', () => howls[idx + 1].play())
            });
            howls[0].play();
        }

        function ntobin(n, length) {
            return ('0'.repeat(length || 0) + (n.toString(2))).slice(-(length || 0));
        }

        const alphabet = 'abcdefghjkmnpqrstuvwxyz123456789';

        function hashToIds(hash) {
            const bits = hash.split('').map(c => ntobin(alphabet.indexOf(c), 5)).join('');
            if (bits.length % 5 !== 0 || bits.length < 29) return [];
            const ids = bits.slice(22).match(/.{7}/g).map(n => parseInt(n, 2));
            return ids.slice(0, 10).filter(id => ALL_IDS.includes(id));
        }

    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.3/howler.min.js"
        integrity="sha512-6+YN/9o9BWrk6wSfGxQGpt3EUK6XeHi6yeHV+TYD2GR0Sj/cggRpXr1BrAQf0as6XslxomMUxXp2vIl+fv0QRA=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.3.2/socket.io.js"
        integrity="sha512-zN6KYOtONNTOGXz0RkWX2EpavN9VdIs+2w+To+fhciFv83YA9maUpi2lzZWrOfKXdFIZZomWufBznkyHi3a8oQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>
        var host = window.location.host === 'localhost' ? 'localhost:3000' : 'https://pinkjelly.herokuapp.com';
        var socket = io(host);

        socket.on('play-mp3', (args) => {
            console.log('Playing MP3', args.url);
            playAudio(args.url, 'mp3');
        });

        socket.on('play-sound', (args) => {
            console.log('Playing sound', args.id);
            playSound(args.id || 0);
        });

        socket.on('play-mashup', (args) => {
            console.log('Playing mashup', args.hash);
            playMashup(args.hash || '');
        });

        socket.on('play-giffy', (args) => {
            console.log('Playing giffy', args.id);
            playGiffy(args.id || '-');
        });

        socket.on('reload', () => {
            window.location.reload();
        });
    </script>
</body>

</html>